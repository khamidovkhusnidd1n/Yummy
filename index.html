<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Yummy - Premium Delivery</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --tg-theme-bg-color: #ffffff;
            --tg-theme-text-color: #000000;
        }

        body {
            font-family: 'Outfit', sans-serif;
            -webkit-tap-highlight-color: transparent;
            background: #fcfcfc;
            overflow-x: hidden;
        }

        .dark body {
            background: #0c0c0c;
            color: white;
        }

        .category-active {
            background: #dc2626 !important;
            color: white !important;
            transform: scale(1.05);
            box-shadow: 0 10px 25px -5px rgba(220, 38, 38, 0.4);
        }

        .product-card {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(0, 0, 0, 0.03);
        }

        .dark .product-card {
            border: 1px solid rgba(255, 255, 255, 0.03);
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.1);
        }

        .price-tag {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        .category-item {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .category-item:active {
            transform: scale(0.9);
        }

        .animate-item {
            animation: slideUp 0.6s ease forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes slideUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        ::-webkit-scrollbar {
            display: none;
        }

        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .dark .glass {
            background: rgba(15, 15, 15, 0.7);
        }

        .image-zoom:hover {
            transform: scale(1.1);
        }

        .image-zoom {
            transition: transform 0.8s cubic-bezier(0.2, 0, 0.2, 1);
        }
    </style>
</head>

<body class="pb-32">
    <!-- Header -->
    <header
        class="fixed top-0 left-0 right-0 z-50 glass border-b border-gray-100 dark:border-zinc-800 px-6 py-4 flex justify-between items-center">
        <div>
            <h1 class="text-2xl font-black tracking-tighter text-red-600">YUMMY</h1>
        </div>
        <div class="flex gap-3">
            <button id="search-toggle"
                class="w-10 h-10 rounded-2xl bg-gray-100 dark:bg-zinc-800 flex items-center justify-center">
                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                    <circle cx="11" cy="11" r="8" />
                    <path d="m21 21-4.3-4.3" />
                </svg>
            </button>
            <button id="cart-btn"
                class="relative w-10 h-10 rounded-2xl bg-black dark:bg-white text-white dark:text-black flex items-center justify-center">
                <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                    <path d="M4 4h2l3 12h10l3-9H7" />
                </svg>
                <span id="cart-count"
                    class="absolute -top-1.5 -right-1.5 bg-red-600 text-[10px] font-black text-white w-5 h-5 rounded-full flex items-center justify-center border-2 border-white dark:border-zinc-900 hidden">0</span>
            </button>
        </div>
    </header>

    <!-- Search Box -->
    <div id="search-container" class="fixed top-20 left-0 right-0 z-40 px-6 py-4 hidden animate-item">
        <input type="text" id="search-input" placeholder="Qanday taom qidiramiz? ðŸ”Ž"
            class="w-full h-14 bg-white dark:bg-zinc-900 rounded-3xl px-6 font-bold shadow-2xl border-2 border-red-500/20 focus:border-red-500 outline-none transition-all">
    </div>

    <!-- Featured Section -->
    <section class="mt-28 px-6">
        <div class="relative w-full h-52 rounded-[45px] overflow-hidden shadow-2xl group">
            <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=1000&fit=crop"
                class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-1000">
            <div
                class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent p-8 flex flex-col justify-end">
                <span
                    class="bg-red-600 text-white text-[10px] font-black px-3 py-1 rounded-full w-fit mb-3 tracking-widest">TOP
                    TANLOV</span>
                <h2 class="text-white text-2xl font-black tracking-tight">Bugun nima yeymiz?</h2>
                <p class="text-white/60 text-xs font-bold mt-1">Barcha taomlar 100% tabiiy va mazali!</p>
            </div>
        </div>
    </section>

    <!-- Categories -->
    <div id="categories-container" class="mt-8 px-6 flex gap-3 overflow-x-auto py-2 no-scrollbar">
        <!-- JS renders this -->
    </div>

    <!-- Menu Grid -->
    <div id="menu-grid" class="mt-6 px-6 grid grid-cols-2 gap-4">
        <!-- JS renders this -->
    </div>

    <!-- Simple Cart Sheet (Overlay) -->
    <div id="cart-modal" class="fixed inset-0 z-[60] hidden">
        <div id="cart-overlay"
            class="absolute inset-0 bg-black/60 backdrop-blur-md opacity-0 transition-opacity duration-500"></div>
        <div id="cart-sheet"
            class="absolute bottom-0 left-0 right-0 bg-white dark:bg-[#0f0f0f] rounded-t-[50px] min-h-[70vh] p-8 translate-y-full transition-transform duration-500 flex flex-col">
            <div class="w-16 h-1.5 bg-gray-200 dark:bg-zinc-800 rounded-full mx-auto mb-8"></div>

            <div class="flex justify-between items-center mb-8">
                <div>
                    <h2 class="text-3xl font-black tracking-tight">Savat</h2>
                    <p class="text-xs text-gray-400 font-bold uppercase tracking-widest mt-1">Siz tanlagan mazali
                        taomlar</p>
                </div>
                <button id="clear-cart"
                    class="text-red-500 font-black text-xs uppercase tracking-wider">Tozalash</button>
            </div>

            <div id="cart-items" class="flex-grow space-y-6 overflow-y-auto max-h-[40vh] pr-2">
                <!-- JS renders items -->
            </div>

            <div class="mt-10 border-t border-gray-100 dark:border-zinc-800 pt-8">
                <div id="cart-total" class="flex justify-between items-end mb-8">
                    <!-- JS renders total -->
                </div>
                <button id="checkout-btn"
                    class="w-full h-18 py-5 price-tag rounded-[30px] font-black text-white text-lg shadow-2xl shadow-red-500/40 active:scale-95 transition-all flex items-center justify-center gap-3">
                    <span>BUYURTMA BERISH</span>
                    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="3" viewBox="0 0 24 24">
                        <path d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        const urlParams = new URLSearchParams(window.location.search);
        const CURRENT_LANG = urlParams.get('lang') || 'uz';

        const LANG_STRINGS = {
            'uz': {
                'delivery': 'Premium Yetkazib Berish',
                'search_placeholder': 'Qanday taom qidiramiz? ðŸ”Ž',
                'top_choice': 'TOP TANLOV',
                'featured_title': 'Bugun nima yeymiz?',
                'featured_sub': 'Barcha taomlar 100% tabiiy va mazali!',
                'not_found': 'Hech nima topilmadi... â˜•ï¸',
                'cart_title': 'Savat',
                'cart_sub': 'Siz tanlagan mazali taomlar',
                'cart_empty': 'Savatingiz bo\'sh ðŸ›’',
                'total_label': 'Umumiy hisob',
                'order_btn': 'BUYURTMA BERISH',
                'food_label': 'Taomlar',
                'deliv_label': 'Yetkazish',
                'confirm_btn': 'TASDIQLASH',
                'cats': {
                    "ðŸŒ¯ Lavash": "ðŸŒ¯ Lavash", "ðŸ” Burger": "ðŸ” Burger", "ðŸ¥™ Doner": "ðŸ¥™ Doner",
                    "ðŸ— KFC": "ðŸ— KFC", "ðŸŒ­ Xot-dog": "ðŸŒ­ Xot-dog", "ðŸ¥ª Xaggi": "ðŸ¥ª Xaggi",
                    "ðŸ— Naggets": "ðŸ— Naggets", "ðŸ§€ Pishloqli yostiqchalar": "ðŸ§€ Pishloqli",
                    "ðŸ¥ª Klab sandwich": "ðŸ¥ª Klab", "ðŸŸ Fri": "ðŸŸ Fri", "ðŸ¥Ÿ Somsa": "ðŸ¥Ÿ Somsa",
                    "â˜•ï¸ Ichimliklar": "â˜•ï¸ Ichimliklar", "ðŸ¹ Cocktails": "ðŸ¹ Cocktails",
                    "ðŸ”¥ Specials": "ðŸ”¥ Maxsus", "ðŸ¥« Souslar": "ðŸ¥« Souslar"
                }
            },
            'ru': {
                'delivery': 'ÐŸÑ€ÐµÐ¼Ð¸ÑƒÐ¼ Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ°',
                'search_placeholder': 'Ð§Ñ‚Ð¾ Ð±ÑƒÐ´ÐµÐ¼ Ð¸ÑÐºÐ°Ñ‚ÑŒ? ðŸ”Ž',
                'top_choice': 'Ð¢ÐžÐŸ Ð’Ð«Ð‘ÐžÐ ',
                'featured_title': 'Ð§Ñ‚Ð¾ Ð¿Ð¾ÐµÐ´Ð¸Ð¼ ÑÐµÐ³Ð¾Ð´Ð½Ñ?',
                'featured_sub': 'Ð’ÑÐµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹ 100% Ð½Ð°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ñ‹Ðµ!',
                'not_found': 'ÐÐ¸Ñ‡ÐµÐ³Ð¾ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾... â˜•ï¸',
                'cart_title': 'ÐšÐ¾Ñ€Ð·Ð¸Ð½Ð°',
                'cart_sub': 'Ð’Ð°ÑˆÐ¸ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ðµ Ð±Ð»ÑŽÐ´Ð°',
                'cart_empty': 'ÐšÐ¾Ñ€Ð·Ð¸Ð½Ð° Ð¿ÑƒÑÑ‚Ð° ðŸ›’',
                'total_label': 'ÐžÐ±Ñ‰Ð°Ñ ÑÑƒÐ¼Ð¼Ð°',
                'order_btn': 'ÐžÐ¤ÐžÐ ÐœÐ˜Ð¢Ð¬ Ð—ÐÐšÐÐ—',
                'food_label': 'Ð‘Ð»ÑŽÐ´Ð°',
                'deliv_label': 'Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ°',
                'confirm_btn': 'ÐŸÐžÐ”Ð¢Ð’Ð•Ð Ð”Ð˜Ð¢Ð¬',
                'cats': {
                    "ðŸŒ¯ Lavash": "ðŸŒ¯ Ð›Ð°Ð²Ð°Ñˆ", "ðŸ” Burger": "ðŸ” Ð‘ÑƒÑ€Ð³ÐµÑ€", "ðŸ¥™ Doner": "ðŸ¥™ Ð”Ð¾Ð½ÐµÑ€",
                    "ðŸ— KFC": "ðŸ— KFC", "ðŸŒ­ Xot-dog": "ðŸŒ­ Ð¥Ð¾Ñ‚-Ð´Ð¾Ð³", "ðŸ¥ª Xaggi": "ðŸ¥ª Ð¥Ð°Ð³Ð³Ð¸",
                    "ðŸ— Naggets": "ðŸ— ÐÐ°Ð³Ð³ÐµÑ‚ÑÑ‹", "ðŸ§€ Pishloqli yostiqchalar": "ðŸ§€ Ð¡Ñ‹Ñ€Ð½Ñ‹Ðµ",
                    "ðŸ¥ª Klab sandwich": "ðŸ¥ª ÐšÐ»Ð°Ð±", "ðŸŸ Fri": "ðŸŸ Ð¤Ñ€Ð¸", "ðŸ¥Ÿ Somsa": "ðŸ¥Ÿ Ð¡Ð¾Ð¼ÑÐ°",
                    "â˜•ï¸ Ichimliklar": "â˜•ï¸ ÐÐ°Ð¿Ð¸Ñ‚ÐºÐ¸", "ðŸ¹ Cocktails": "ðŸ¹ ÐšÐ¾ÐºÑ‚ÐµÐ¹Ð»Ð¸",
                    "ðŸ”¥ Specials": "ðŸ”¥ ÐÐºÑ†Ð¸Ð¸", "ðŸ¥« Souslar": "ðŸ¥« Ð¡Ð¾ÑƒÑÑ‹"
                }
            },
            'en': {
                'delivery': 'Premium Delivery',
                'search_placeholder': 'What are we looking for? ðŸ”Ž',
                'top_choice': 'TOP CHOICE',
                'featured_title': 'What shall we eat today?',
                'featured_sub': 'All ingredients are 100% natural!',
                'not_found': 'Nothing found... â˜•ï¸',
                'cart_title': 'Cart',
                'cart_sub': 'Your selected delicious items',
                'cart_empty': 'Your cart is empty ðŸ›’',
                'total_label': 'Total amount',
                'order_btn': 'PLACE ORDER',
                'food_label': 'Food',
                'deliv_label': 'Delivery',
                'confirm_btn': 'CONFIRM',
                'cats': {
                    "ðŸŒ¯ Lavash": "ðŸŒ¯ Lavash", "ðŸ” Burger": "ðŸ” Burger", "ðŸ¥™ Doner": "ðŸ¥™ Doner",
                    "ðŸ— KFC": "ðŸ— KFC", "ðŸŒ­ Xot-dog": "ðŸŒ­ Hot-dog", "ðŸ¥ª Xaggi": "ðŸ¥ª Haggi",
                    "ðŸ— Naggets": "ðŸ— Nuggets", "ðŸ§€ Pishloqli yostiqchalar": "ðŸ§€ Cheese pods",
                    "ðŸ¥ª Klab sandwich": "ðŸ¥ª Club", "ðŸŸ Fri": "ðŸŸ Fries", "ðŸ¥Ÿ Somsa": "ðŸ¥Ÿ Somsa",
                    "â˜•ï¸ Ichimliklar": "â˜•ï¸ Drinks", "ðŸ¹ Cocktails": "ðŸ¹ Cocktails",
                    "ðŸ”¥ Specials": "ðŸ”¥ Specials", "ðŸ¥« Souslar": "ðŸ¥« Sauces"
                }
            }
        };

        const S = LANG_STRINGS[CURRENT_LANG] || LANG_STRINGS['uz'];

        // Apply Static Translations
        document.getElementById('search-input').placeholder = S.search_placeholder;
        document.querySelector('.bg-red-600.text-white.text-\\[10px\\]').innerText = S.top_choice;
        document.querySelector('h2.text-white.text-2xl').innerText = S.featured_title;
        document.querySelector('p.text-white\\/60').innerText = S.featured_sub;
        document.querySelector('#cart-sheet h2').innerText = S.cart_title;
        document.querySelector('#cart-sheet p.text-gray-400').innerText = S.cart_sub;
        document.querySelector('#checkout-btn span').innerText = S.order_btn;

        tg.expand();
        tg.ready();

        if (tg.colorScheme === 'dark') {
            document.documentElement.classList.add('dark');
            tg.setHeaderColor('#0f0f0f');
            tg.setBackgroundColor('#0c0c0c');
        }

        const MENU_DATA = {
            "ðŸŒ¯ Lavash": [
                { "n": "Standart", "p": 30000, "i": "images/lavash.png" },
                { "n": "Pishloqli", "p": 35000, "i": "images/lavash.png" },
                { "n": "Big", "p": 40000, "i": "images/lavash.png" },
                { "n": "Big pishloq", "p": 45000, "i": "images/lavash.png" }
            ],
            "ðŸ” Burger": [
                { "n": "Gamburger", "p": 28000, "i": "images/burger.png" },
                { "n": "Chizburger", "p": 33000, "i": "images/burger.png" },
                { "n": "Double", "p": 35000, "i": "images/double_burger.png" },
                { "n": "Double chiz", "p": 40000, "i": "images/double_burger.png" }
            ],
            "ðŸ¥™ Doner": [
                { "n": "Standart", "p": 25000, "i": "images/image2/donar.png" },
                { "n": "Big", "p": 30000, "i": "images/image2/donar.png" },
                { "n": "Chiz", "p": 35000, "i": "images/image2/donar.png" }
            ],
            "ðŸ— KFC": [
                { "n": "File strips", "p": 90000, "i": "images/kfc_strips.png" },
                { "n": "Qanot", "p": 85000, "i": "images/kfc_wings.png" },
                { "n": "Lunch box", "p": 30000, "i": "images/kfc_lunch.png" },
                { "n": "Kfc xaggi", "p": 30000, "i": "images/image2/xaggi.png" }
            ],
            "ðŸŒ­ Xot-dog": [
                { "n": "Mini", "p": 10000, "i": "images/image2/hot_dog.png" },
                { "n": "Twins", "p": 17000, "i": "images/image2/hot_dog.png" },
                { "n": "Big (45sm)", "p": 22000, "i": "images/image2/hot_dog.png" },
                { "n": "Super (45sm)", "p": 25000, "i": "images/image2/hot_dog.png" },
                { "n": "Canada (45sm)", "p": 25000, "i": "images/hotdog_canada.png" }
            ],
            "ðŸ¥ª Xaggi": [
                { "n": "Standart", "p": 35000, "i": "images/image2/xaggi.png" },
                { "n": "Big", "p": 45000, "i": "images/image2/xaggi.png" },
                { "n": "Xot let", "p": 28000, "i": "images/image2/xaggi.png" }
            ],
            "ðŸ— Naggets": [
                { "n": "Naggets", "p": 22000, "i": "images/naggets.png" },
                { "n": "Naggets mini", "p": 11000, "i": "images/naggets.png" }
            ],
            "ðŸ§€ Pishloqli yostiqchalar": [
                { "n": "Yostiqchalar", "p": 28000, "i": "images/pishloqli.png" },
                { "n": "Yostiqchalar mini", "p": 14000, "i": "images/pishloqli.png" }
            ],
            "ðŸ¥ª Klab sandwich": [
                { "n": "Standart", "p": 35000, "i": "images/sandwich.png" }
            ],
            "ðŸŸ Fri": [
                { "n": "Standart", "p": 15000, "i": "images/fri.png" },
                { "n": "Big", "p": 17000, "i": "images/fri.png" }
            ],
            "ðŸ¥Ÿ Somsa": [
                { "n": "Go'shtli", "p": 10000, "i": "images/somsa.png" },
                { "n": "Pishloqli tovuq", "p": 7000, "i": "images/somsa.png" },
                { "n": "Ko'k", "p": 5000, "i": "images/somsa.png" },
                { "n": "Kartoshka", "p": 5000, "i": "images/somsa.png" }
            ],
            "â˜•ï¸ Ichimliklar": [
                { "n": "Choy", "p": 3000, "i": "images/image2/tea.png" },
                { "n": "Kofe", "p": 5000, "i": "images/image2/coffee.png" },
                { "n": "Kofe (Big)", "p": 7000, "i": "images/image2/coffee.png" },
                { "n": "Choy mevali", "p": 10000, "i": "images/image2/tea_via_fruits.png" }
            ],
            "ðŸ¹ Cocktails": [
                { "n": "Tropic", "p": 15000, "i": "images/image2/tropic.png" },
                { "n": "Moxito", "p": 15000, "i": "images/image2/moxito.png" },
                { "n": "O'rmon mevalari", "p": 15000, "i": "images/image2/forest_fruits.png" }
            ],
            "ðŸ”¥ Specials": [
                { "n": "Kfc BURGER (+0.25 Cola)", "p": 33000, "i": "images/image2/kfc_burger.png" },
                { "n": "Kfc HAGGI (+0.25 Cola)", "p": 38000, "i": "images/image2/kfc_haggi_cola.png" }
            ],
            "ðŸ¥« Souslar": [
                { "n": "Sous", "p": 4000, "i": "images/image2/sous.png" }
            ]
        };

        let cart = [];
        let activeCategory = Object.keys(MENU_DATA)[0];
        let idCounter = 1;

        const FLAT_ITEMS = [];
        Object.keys(MENU_DATA).forEach(cat => {
            MENU_DATA[cat].forEach(item => {
                FLAT_ITEMS.push({ id: idCounter++, name: item.n, price: item.p, image: item.i, cat: cat });
            });
        });

        function renderCategories() {
            const container = document.getElementById('categories-container');
            container.innerHTML = Object.keys(MENU_DATA).map(cat => `
                <button onclick="selectCategory('${cat}')" 
                    class="category-item whitespace-nowrap px-8 py-3.5 rounded-3xl text-sm font-black tracking-tight transition-all ${activeCategory === cat ? 'category-active' : 'bg-gray-100 dark:bg-zinc-800 text-gray-500 dark:text-zinc-500'}">
                    ${S.cats[cat] || cat}
                </button>
            `).join('');
        }

        function renderMenu(filter = "") {
            const container = document.getElementById('menu-grid');
            const itemsToRender = FLAT_ITEMS.filter(i =>
                (filter === "" ? i.cat === activeCategory : i.name.toLowerCase().includes(filter.toLowerCase()))
            );

            container.innerHTML = itemsToRender.map((item, idx) => `
                <div class="product-card animate-item bg-white dark:bg-[#1a1a1a] rounded-[45px] p-3 shadow-xl shadow-black/5 flex flex-col justify-between group" style="animation-delay: ${idx * 0.05}s">
                    <div class="relative w-full aspect-square bg-gray-50 dark:bg-zinc-800 rounded-[38px] overflow-hidden">
                        <img src="${item.image}" 
                             onerror="this.onerror=null; this.src='images/burger.png';" 
                             class="w-full h-full object-cover image-zoom">
                        <button onclick="addToCart(${item.id})" class="absolute bottom-2 right-2 w-9 h-9 price-tag rounded-full shadow-md shadow-red-500/30 flex items-center justify-center text-white active:scale-90 transition-all hover:scale-110">
                            <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="3.5" viewBox="0 0 24 24"><path d="M12 4v16m8-8H4"/></svg>
                        </button>
                    </div>
                    <div class="px-5 py-6">
                        <h3 class="font-black text-sm tracking-tight text-gray-800 dark:text-zinc-100 line-clamp-1">${item.name}</h3>
                        <p class="text-red-500 font-extrabold text-[16px] mt-2 tracking-tighter">${item.price.toLocaleString()} so'm</p>
                    </div>
                </div>
            `).join('') || `<div class="col-span-2 py-20 text-center text-gray-400 font-bold">${S.not_found}</div>`;
        }

        window.selectCategory = (cat) => { activeCategory = cat; renderCategories(); renderMenu(); if (tg.HapticFeedback) tg.HapticFeedback.selectionChanged(); }
        window.addToCart = (id) => { const item = FLAT_ITEMS.find(i => i.id === id); const inCart = cart.find(i => i.id === id); if (inCart) inCart.quantity += 1; else cart.push({ ...item, quantity: 1 }); updateCartUI(); if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium'); }

        function updateCartUI() {
            const count = cart.reduce((sum, i) => sum + i.quantity, 0);
            const countEl = document.getElementById('cart-count');
            if (count > 0) { countEl.innerText = count; countEl.classList.remove('hidden'); tg.MainButton.setText(`${S.confirm_btn} (${count})`); tg.MainButton.show(); tg.MainButton.setParams({ color: '#dc2626', text_color: '#ffffff' }); }
            else { countEl.classList.add('hidden'); tg.MainButton.hide(); }
        }

        const modal = document.getElementById('cart-modal');
        const sheet = document.getElementById('cart-sheet');
        const overlay = document.getElementById('cart-overlay');

        function openCart() {
            modal.classList.remove('hidden');
            setTimeout(() => { overlay.style.opacity = "1"; sheet.classList.remove('translate-y-full'); }, 10);
            renderCartItems();
        }

        function closeCart() {
            overlay.style.opacity = "0"; sheet.classList.add('translate-y-full');
            setTimeout(() => modal.classList.add('hidden'), 500);
        }

        function renderCartItems() {
            const container = document.getElementById('cart-items');
            let total = cart.reduce((sum, i) => sum + (i.price * i.quantity), 0);
            if (cart.length === 0) { container.innerHTML = `<div class="py-10 text-center text-gray-400 font-bold tracking-tight">${S.cart_empty}</div>`; }
            else {
                container.innerHTML = cart.map(item => `
                    <div class="flex items-center gap-5 animate-item">
                        <div class="w-20 h-20 rounded-[28px] bg-gray-50 flex-shrink-0 overflow-hidden shadow-sm">
                            <img src="${item.image}" 
                                 onerror="this.onerror=null; this.src='images/burger.png';"
                                 class="w-full h-full object-cover">
                        </div>
                        <div class="flex-grow"><h4 class="font-black text-base tracking-tighter">${item.name}</h4><p class="text-red-500 font-extrabold text-sm mt-1">${item.price.toLocaleString()} so'm</p></div>
                        <div class="flex items-center gap-4 bg-gray-100 dark:bg-zinc-800 rounded-3xl p-2">
                            <button onclick="changeQty(${item.id}, -1)" class="w-8 h-8 rounded-2xl bg-white dark:bg-zinc-700 shadow-md flex items-center justify-center font-black">-</button>
                            <span class="text-sm font-black w-4 text-center">${item.quantity}</span>
                            <button onclick="changeQty(${item.id}, 1)" class="w-8 h-8 rounded-2xl bg-white dark:bg-zinc-700 shadow-md flex items-center justify-center font-black">+</button>
                        </div>
                    </div>
                `).join('');
            }
            const deliveryFee = 15000;
            const finalTotal = total > 0 ? total + deliveryFee : 0;
            document.getElementById('cart-total').innerHTML = `<div class="text-right"><p class="text-[10px] text-gray-400 font-bold uppercase tracking-widest mb-1">${S.food_label}: ${total.toLocaleString()} so'm</p><p class="text-[10px] text-red-500 font-bold uppercase tracking-widest mb-2">${S.deliv_label}: ${deliveryFee.toLocaleString()} so'm</p><p class="text-4xl font-black tracking-tighter text-red-600">${finalTotal.toLocaleString()} so'm</p></div>`;
        }

        window.changeQty = (id, delta) => { const idx = cart.findIndex(i => i.id === id); cart[idx].quantity += delta; if (cart[idx].quantity <= 0) cart.splice(idx, 1); renderCartItems(); updateCartUI(); if (cart.length === 0) closeCart(); if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light'); }
        document.getElementById('cart-btn').onclick = openCart;
        overlay.onclick = closeCart;
        document.getElementById('clear-cart').onclick = () => { cart = []; updateCartUI(); closeCart(); };
        document.getElementById('checkout-btn').onclick = () => { const total = cart.reduce((sum, i) => sum + (i.price * i.quantity), 0); const deliveryFee = 15000; tg.sendData(JSON.stringify({ type: 'order', items: cart, total: (total + deliveryFee) })); tg.close(); };
        tg.onEvent('mainButtonClicked', openCart);
        const toggle = document.getElementById('search-toggle');
        const box = document.getElementById('search-container');
        const input = document.getElementById('search-input');
        toggle.onclick = () => { box.classList.toggle('hidden'); if (!box.classList.contains('hidden')) input.focus(); }
        input.oninput = (e) => renderMenu(e.target.value);
        renderCategories();
        renderMenu();
    </script>
</body>

</html>